{"failedCount":1,"prefixedPath":"classpath:features\/measures\/measure-03.feature","packageQualifiedName":"features.measures.measure-03","loopIndex":-1,"relativePath":"features\/measures\/measure-03.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":237208,"startTime":1770740033128,"endTime":1770740033128,"millis":0.237208,"status":"passed"},"step":{"background":true,"line":4,"prefix":"*","index":0,"text":"def measureId = '3ProportionStringCriteria'"},"stepLog":"11:13:53.123 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• \n11:13:53.123 Karate Environment: dev \n11:13:53.123 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• \n11:13:53.124 FHIR Server: http:\/\/localhost:8000 \n11:13:53.124 Report Type: summary \n11:13:53.124 Test Patients: [\n  \"patient1\",\n  \"patient2\"\n]\n \n11:13:53.124 Save Reports: true \n11:13:53.124 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n \n"},{"result":{"nanos":111533041,"startTime":1770740033128,"endTime":1770740033240,"millis":111.533041,"status":"passed"},"step":{"comments":["# Step 1: Evaluate measure (calls common function)"],"line":9,"prefix":"*","index":0,"text":"def result = call read('classpath:features\/common\/evaluate-measure.feature') { measureId: '#(measureId)' }"},"callResults":[{"prefixedPath":"classpath:features\/common\/evaluate-measure.feature","loopIndex":-1,"callDepth":1,"description":"","resultDate":"2026-02-10 11:13:53 a.m.","durationMillis":104.209002,"callArg":{"measureId":"3ProportionStringCriteria"},"failedCount":0,"packageQualifiedName":"features.common.evaluate-measure","relativePath":"features\/common\/evaluate-measure.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":42584,"startTime":1770740033132,"endTime":1770740033132,"millis":0.042584,"status":"passed"},"step":{"background":true,"line":5,"prefix":"*","index":0,"text":"url fhirServerUrl"}},{"result":{"nanos":115625,"startTime":1770740033132,"endTime":1770740033132,"millis":0.115625,"status":"passed"},"step":{"background":true,"line":6,"prefix":"*","index":1,"text":"configure headers = { 'Content-Type': 'application\/fhir+json', 'Accept': 'application\/fhir+json' }"}},{"result":{"nanos":312709,"startTime":1770740033132,"endTime":1770740033132,"millis":0.312709,"status":"passed"},"step":{"background":true,"line":7,"prefix":"*","index":2,"text":"def Base64 = Java.type('java.util.Base64')"}},{"result":{"nanos":259375,"startTime":1770740033132,"endTime":1770740033132,"millis":0.259375,"status":"passed"},"step":{"background":true,"line":8,"prefix":"*","index":3,"text":"def credentials = auth.username + ':' + auth.password"}},{"result":{"nanos":348042,"startTime":1770740033133,"endTime":1770740033133,"millis":0.348042,"status":"passed"},"step":{"background":true,"line":9,"prefix":"*","index":4,"text":"def encodedCredentials = Base64.getEncoder().encodeToString(credentials.getBytes())"}},{"result":{"nanos":120791,"startTime":1770740033133,"endTime":1770740033133,"millis":0.120791,"status":"passed"},"step":{"background":true,"line":10,"prefix":"*","index":5,"text":"header Authorization = 'Basic ' + encodedCredentials"}},{"result":{"nanos":172333,"startTime":1770740033133,"endTime":1770740033133,"millis":0.172333,"status":"passed"},"step":{"line":13,"prefix":"*","index":0,"text":"def measureId = __arg.measureId"}},{"result":{"nanos":5210791,"startTime":1770740033133,"endTime":1770740033138,"millis":5.210791,"status":"passed"},"step":{"endLine":33,"line":14,"prefix":"*","docString":"{\n  \"resourceType\": \"Parameters\",\n  \"parameter\": [\n    {\n      \"name\": \"periodStart\",\n      \"valueString\": \"#(evaluationParams.periodStart)\"\n    },\n    {\n      \"name\": \"periodEnd\",\n      \"valueString\": \"#(evaluationParams.periodEnd)\"\n    },\n    {\n      \"name\": \"measureId\",\n      \"valueString\": \"#(measureId)\"\n    }\n  ]\n}","index":1,"text":"def evaluationRequest ="}},{"result":{"nanos":328959,"startTime":1770740033139,"endTime":1770740033139,"millis":0.328959,"status":"passed"},"step":{"line":35,"prefix":"Given","index":2,"text":"path 'Measure', '$evaluate-measures'"}},{"result":{"nanos":39959,"startTime":1770740033139,"endTime":1770740033139,"millis":0.039959,"status":"passed"},"step":{"line":36,"prefix":"And","index":3,"text":"request evaluationRequest"}},{"result":{"nanos":96583917,"startTime":1770740033139,"endTime":1770740033236,"millis":96.583917,"status":"passed"},"step":{"line":37,"prefix":"When","index":4,"text":"method post"},"stepLog":"11:13:53.141 request:\n1 > POST http:\/\/localhost:8000\/Measure\/$evaluate-measures\n1 > Authorization: Basic YWRtaW46cGFzc3dvcmQ=\n1 > Content-Type: application\/fhir+json; charset=UTF-8\n1 > Accept: application\/fhir+json\n1 > Content-Length: 204\n1 > Host: localhost:8000\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/21)\n1 > Accept-Encoding: gzip,deflate\n{\n  \"resourceType\": \"Parameters\",\n  \"parameter\": [\n    {\n      \"name\": \"periodStart\",\n      \"valueString\": \"2024-01-01\"\n    },\n    {\n      \"name\": \"periodEnd\",\n      \"valueString\": \"2024-12-31\"\n    },\n    {\n      \"name\": \"measureId\",\n      \"valueString\": \"3ProportionStringCriteria\"\n    }\n  ]\n}\n\n\n11:13:53.235 response time in milliseconds: 93\n1 < 200\n1 < Date: Tue, 10 Feb 2026 16:13:53 GMT\n1 < Vary: Origin\n1 < Vary: Access-Control-Request-Method\n1 < Vary: Access-Control-Request-Headers\n1 < X-Powered-By: Smile CDR 2026.02.PRE FHIR REST Endpoint (FHIR Server; FHIR 4.0.1\/R4; HAPI FHIR 8.7.11-SNAPSHOT)\n1 < X-Request-ID: USZ9vWNHT4VNTx00\n1 < Content-Type: application\/fhir+json;charset=utf-8\n1 < X-Content-Type-Options: nosniff\n1 < X-XSS-Protection: 0\n1 < Cache-Control: no-cache, no-store, max-age=0, must-revalidate\n1 < Pragma: no-cache\n1 < Expires: 0\n1 < X-Frame-Options: DENY\n1 < Transfer-Encoding: chunked\n{\n  \"resourceType\": \"Parameters\",\n  \"parameter\": [\n    {\n      \"name\": \"return\",\n      \"resource\": {\n        \"resourceType\": \"Bundle\",\n        \"id\": \"ff24468b-bc80-442f-b8b3-9a9cf50dd860\",\n        \"identifier\": {\n          \"system\": \"urn:ietf:rfc:3986\",\n          \"value\": \"urn:uuid:5357b71c-6936-42a9-8e0d-6385de0d1191\"\n        },\n        \"type\": \"searchset\",\n        \"timestamp\": \"2026-02-10T11:13:53.222-05:00\",\n        \"entry\": [\n          {\n            \"fullUrl\": \"http:\/\/localhost:8000\/MeasureReport\/e9a08ac1-4041-4493-9429-6c889b20e569\",\n            \"resource\": {\n              \"resourceType\": \"MeasureReport\",\n              \"id\": \"e9a08ac1-4041-4493-9429-6c889b20e569\",\n              \"contained\": [\n                {\n                  \"resourceType\": \"Observation\",\n                  \"id\": \"86b95c4e-7e78-4f78-b947-b853ebc97031\",\n                  \"extension\": [\n                    {\n                      \"url\": \"http:\/\/hl7.org\/fhir\/StructureDefinition\/cqf-measureInfo\",\n                      \"extension\": [\n                        {\n                          \"url\": \"measure\",\n                          \"valueCanonical\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\"\n                        }\n                      ]\n                    }\n                  ],\n                  \"status\": \"final\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"code\": \"F\"\n                      }\n                    ]\n                  },\n                  \"valueInteger\": 2\n                }\n              ],\n              \"extension\": [\n                {\n                  \"url\": \"http:\/\/hl7.org\/fhir\/5.0\/StructureDefinition\/extension-MeasureReport.supplementalDataElement.reference\",\n                  \"valueReference\": {\n                    \"extension\": [\n                      {\n                        \"url\": \"http:\/\/hl7.org\/fhir\/us\/davinci-deqm\/StructureDefinition\/extension-criteriaReference\",\n                        \"valueString\": \"sde-patient-sex\"\n                      }\n                    ],\n                    \"reference\": \"#86b95c4e-7e78-4f78-b947-b853ebc97031\"\n                  }\n                }\n              ],\n              \"status\": \"complete\",\n              \"type\": \"summary\",\n              \"measure\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\",\n              \"date\": \"2026-02-10T11:13:53-05:00\",\n              \"period\": {\n                \"start\": \"2023-12-31T19:00:00-05:00\",\n                \"end\": \"2024-12-31T18:59:59-05:00\"\n              },\n              \"group\": [\n                {\n                  \"id\": \"group-1\",\n                  \"population\": [\n                    {\n                      \"id\": \"initial-population\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"initial-population\",\n                            \"display\": \"Initial Population\"\n                          }\n                        ]\n                      },\n                      \"count\": 6\n                    },\n                    {\n                      \"id\": \"denominator\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"denominator\",\n                            \"display\": \"Denominator\"\n                          }\n                        ]\n                      },\n                      \"count\": 4\n                    },\n                    {\n                      \"id\": \"denominator-exclusion\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"denominator-exclusion\",\n                            \"display\": \"Denominator-Exclusion\"\n                          }\n                        ]\n                      },\n                      \"count\": 0\n                    },\n                    {\n                      \"id\": \"denominator-exception\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"denominator-exception\",\n                            \"display\": \"Denominator-Exception\"\n                          }\n                        ]\n                      },\n                      \"count\": 0\n                    },\n                    {\n                      \"id\": \"numerator\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"numerator\",\n                            \"display\": \"Numerator\"\n                          }\n                        ]\n                      },\n                      \"count\": 2\n                    },\n                    {\n                      \"id\": \"numerator-exclusion\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"numerator-exclusion\",\n                            \"display\": \"Numerator-Exclusion\"\n                          }\n                        ]\n                      },\n                      \"count\": 0\n                    }\n                  ],\n                  \"measureScore\": {\n                    \"value\": 0.5\n                  },\n                  \"stratifier\": [\n                    {\n                      \"id\": \"stratifier-1\",\n                      \"code\": [\n                        {\n                          \"text\": \"Age and Gender Stratification\"\n                        }\n                      ],\n                      \"stratum\": [\n                        {\n                          \"value\": {\n                            \"text\": \"female\"\n                          },\n                          \"population\": [\n                            {\n                              \"id\": \"initial-population\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"initial-population\",\n                                    \"display\": \"Initial Population\"\n                                  }\n                                ]\n                              },\n                              \"count\": 3\n                            },\n                            {\n                              \"id\": \"denominator\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"denominator\",\n                                    \"display\": \"Denominator\"\n                                  }\n                                ]\n                              },\n                              \"count\": 2\n                            },\n                            {\n                              \"id\": \"denominator-exclusion\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"denominator-exclusion\",\n                                    \"display\": \"Denominator-Exclusion\"\n                                  }\n                                ]\n                              },\n                              \"count\": 0\n                            },\n                            {\n                              \"id\": \"denominator-exception\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"denominator-exception\",\n                                    \"display\": \"Denominator-Exception\"\n                                  }\n                                ]\n                              },\n                              \"count\": 0\n                            },\n                            {\n                              \"id\": \"numerator\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"numerator\",\n                                    \"display\": \"Numerator\"\n                                  }\n                                ]\n                              },\n                              \"count\": 1\n                            },\n                            {\n                              \"id\": \"numerator-exclusion\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"numerator-exclusion\",\n                                    \"display\": \"Numerator-Exclusion\"\n                                  }\n                                ]\n                              },\n                              \"count\": 0\n                            }\n                          ],\n                          \"measureScore\": {\n                            \"value\": 0.5\n                          }\n                        }\n                      ]\n                    }\n                  ]\n                }\n              ]\n            }\n          }\n        ]\n      }\n    }\n  ]\n}\n\n\n"},{"result":{"nanos":11292,"startTime":1770740033236,"endTime":1770740033236,"millis":0.011292,"status":"passed"},"step":{"line":38,"prefix":"Then","index":5,"text":"status 200"}},{"result":{"nanos":481000,"startTime":1770740033236,"endTime":1770740033236,"millis":0.481,"status":"passed"},"step":{"line":40,"prefix":"*","index":6,"text":"def bundle = response.parameter[0].resource"}},{"result":{"nanos":181625,"startTime":1770740033236,"endTime":1770740033236,"millis":0.181625,"status":"passed"},"step":{"line":41,"prefix":"*","index":7,"text":"def measureReport = bundle.entry[0].resource"}}],"line":12,"description":"","durationMillis":104.209002,"failed":false,"tags":["ignore"],"executorName":"main","name":"Evaluate Measure","startTime":1770740033132,"refId":"[1:12]","endTime":1770740033236,"exampleIndex":-1}],"name":"Common Measure Evaluation Function","passedCount":1}]},{"result":{"nanos":226584,"startTime":1770740033239,"endTime":1770740033239,"millis":0.226584,"status":"passed"},"step":{"line":10,"prefix":"*","index":1,"text":"def actualReport = result.measureReport"}},{"result":{"nanos":612792,"startTime":1770740033240,"endTime":1770740033241,"millis":0.612792,"status":"passed"},"step":{"line":11,"prefix":"*","index":2,"text":"karate.log('actualReport:', actualReport)"},"stepLog":"11:13:53.240 actualReport: {\n  \"resourceType\": \"MeasureReport\",\n  \"id\": \"e9a08ac1-4041-4493-9429-6c889b20e569\",\n  \"contained\": [\n    {\n      \"resourceType\": \"Observation\",\n      \"id\": \"86b95c4e-7e78-4f78-b947-b853ebc97031\",\n      \"extension\": [\n        {\n          \"url\": \"http:\/\/hl7.org\/fhir\/StructureDefinition\/cqf-measureInfo\",\n          \"extension\": [\n            {\n              \"url\": \"measure\",\n              \"valueCanonical\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\"\n            }\n          ]\n        }\n      ],\n      \"status\": \"final\",\n      \"code\": {\n        \"coding\": [\n          {\n            \"code\": \"F\"\n          }\n        ]\n      },\n      \"valueInteger\": 2\n    }\n  ],\n  \"extension\": [\n    {\n      \"url\": \"http:\/\/hl7.org\/fhir\/5.0\/StructureDefinition\/extension-MeasureReport.supplementalDataElement.reference\",\n      \"valueReference\": {\n        \"extension\": [\n          {\n            \"url\": \"http:\/\/hl7.org\/fhir\/us\/davinci-deqm\/StructureDefinition\/extension-criteriaReference\",\n            \"valueString\": \"sde-patient-sex\"\n          }\n        ],\n        \"reference\": \"#86b95c4e-7e78-4f78-b947-b853ebc97031\"\n      }\n    }\n  ],\n  \"status\": \"complete\",\n  \"type\": \"summary\",\n  \"measure\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\",\n  \"date\": \"2026-02-10T11:13:53-05:00\",\n  \"period\": {\n    \"start\": \"2023-12-31T19:00:00-05:00\",\n    \"end\": \"2024-12-31T18:59:59-05:00\"\n  },\n  \"group\": [\n    {\n      \"id\": \"group-1\",\n      \"population\": [\n        {\n          \"id\": \"initial-population\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"initial-population\",\n                \"display\": \"Initial Population\"\n              }\n            ]\n          },\n          \"count\": 6\n        },\n        {\n          \"id\": \"denominator\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"denominator\",\n                \"display\": \"Denominator\"\n              }\n            ]\n          },\n          \"count\": 4\n        },\n        {\n          \"id\": \"denominator-exclusion\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"denominator-exclusion\",\n                \"display\": \"Denominator-Exclusion\"\n              }\n            ]\n          },\n          \"count\": 0\n        },\n        {\n          \"id\": \"denominator-exception\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"denominator-exception\",\n                \"display\": \"Denominator-Exception\"\n              }\n            ]\n          },\n          \"count\": 0\n        },\n        {\n          \"id\": \"numerator\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"numerator\",\n                \"display\": \"Numerator\"\n              }\n            ]\n          },\n          \"count\": 2\n        },\n        {\n          \"id\": \"numerator-exclusion\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"numerator-exclusion\",\n                \"display\": \"Numerator-Exclusion\"\n              }\n            ]\n          },\n          \"count\": 0\n        }\n      ],\n      \"measureScore\": {\n        \"value\": 0.5\n      },\n      \"stratifier\": [\n        {\n          \"id\": \"stratifier-1\",\n          \"code\": [\n            {\n              \"text\": \"Age and Gender Stratification\"\n            }\n          ],\n          \"stratum\": [\n            {\n              \"value\": {\n                \"text\": \"female\"\n              },\n              \"population\": [\n                {\n                  \"id\": \"initial-population\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"initial-population\",\n                        \"display\": \"Initial Population\"\n                      }\n                    ]\n                  },\n                  \"count\": 3\n                },\n                {\n                  \"id\": \"denominator\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"denominator\",\n                        \"display\": \"Denominator\"\n                      }\n                    ]\n                  },\n                  \"count\": 2\n                },\n                {\n                  \"id\": \"denominator-exclusion\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"denominator-exclusion\",\n                        \"display\": \"Denominator-Exclusion\"\n                      }\n                    ]\n                  },\n                  \"count\": 0\n                },\n                {\n                  \"id\": \"denominator-exception\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"denominator-exception\",\n                        \"display\": \"Denominator-Exception\"\n                      }\n                    ]\n                  },\n                  \"count\": 0\n                },\n                {\n                  \"id\": \"numerator\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"numerator\",\n                        \"display\": \"Numerator\"\n                      }\n                    ]\n                  },\n                  \"count\": 1\n                },\n                {\n                  \"id\": \"numerator-exclusion\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"numerator-exclusion\",\n                        \"display\": \"Numerator-Exclusion\"\n                      }\n                    ]\n                  },\n                  \"count\": 0\n                }\n              ],\n              \"measureScore\": {\n                \"value\": 0.5\n              }\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n \n"},{"result":{"nanos":245333,"startTime":1770740033240,"endTime":1770740033240,"millis":0.245333,"status":"passed"},"step":{"line":12,"prefix":"*","index":3,"text":"karate.log('actualReport type:', typeof actualReport)"},"stepLog":"11:13:53.241 actualReport type: object \n"},{"result":{"nanos":4780042,"startTime":1770740033241,"endTime":1770740033246,"millis":4.780042,"status":"passed"},"step":{"comments":["# Save actual report to file for review"],"line":15,"prefix":"*","index":4,"text":"def actualReportFile = 'test-output\/actual-reports\/' + measureId + '-actual.json'"}},{"result":{"nanos":81558375,"startTime":1770740033246,"endTime":1770740033328,"millis":81.558375,"status":"passed"},"step":{"line":16,"prefix":"*","index":5,"text":"karate.write(actualReport, actualReportFile)"},"stepLog":"11:13:53.327 write to file: target\/test-output\/actual-reports\/3ProportionStringCriteria-actual.json\n"},{"result":{"nanos":11897083,"startTime":1770740033328,"endTime":1770740033340,"millis":11.897083,"status":"passed"},"step":{"line":17,"prefix":"*","index":6,"text":"karate.log('ðŸ’¾ Actual report saved to:', actualReportFile)"},"stepLog":"11:13:53.339 ðŸ’¾ Actual report saved to: test-output\/actual-reports\/3ProportionStringCriteria-actual.json \n"},{"result":{"nanos":2906375,"startTime":1770740033340,"endTime":1770740033343,"millis":2.906375,"status":"passed"},"step":{"comments":["# Step 2: Load expected report"],"line":20,"prefix":"*","index":7,"text":"def expectedReportRaw = read('classpath:expected-results\/3ProportionStringCriteriaResponse.json')"}},{"result":{"nanos":631875,"startTime":1770740033342,"endTime":1770740033343,"millis":0.631875,"status":"passed"},"step":{"line":21,"prefix":"*","index":8,"text":"karate.log('expectedReportRaw:', expectedReportRaw)"},"stepLog":"11:13:53.343 expectedReportRaw: {\n  \"resourceType\": \"Parameters\",\n  \"parameter\": [\n    {\n      \"name\": \"return\",\n      \"resource\": {\n        \"resourceType\": \"Bundle\",\n        \"id\": \"17681ed9-22ec-439b-9b65-712c03fcfac2\",\n        \"identifier\": {\n          \"system\": \"urn:ietf:rfc:3986\",\n          \"value\": \"urn:uuid:863fdff7-a802-435c-8587-da462bb24f85\"\n        },\n        \"type\": \"searchset\",\n        \"timestamp\": \"2026-02-09T15:34:23.889-05:00\",\n        \"entry\": [\n          {\n            \"fullUrl\": \"http:\/\/localhost:8000\/MeasureReport\/f17a88f5-8c03-466e-9de7-7e246ae38fa1\",\n            \"resource\": {\n              \"resourceType\": \"MeasureReport\",\n              \"id\": \"f17a88f5-8c03-466e-9de7-7e246ae38fa1\",\n              \"contained\": [\n                {\n                  \"resourceType\": \"Observation\",\n                  \"id\": \"909a511c-823f-4f4c-8012-34f987cc4ae2\",\n                  \"extension\": [\n                    {\n                      \"url\": \"http:\/\/hl7.org\/fhir\/StructureDefinition\/cqf-measureInfo\",\n                      \"extension\": [\n                        {\n                          \"url\": \"measure\",\n                          \"valueCanonical\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\"\n                        }\n                      ]\n                    }\n                  ],\n                  \"status\": \"final\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"code\": \"F\"\n                      }\n                    ]\n                  },\n                  \"valueInteger\": 2\n                }\n              ],\n              \"extension\": [\n                {\n                  \"url\": \"http:\/\/hl7.org\/fhir\/5.0\/StructureDefinition\/extension-MeasureReport.supplementalDataElement.reference\",\n                  \"valueReference\": {\n                    \"extension\": [\n                      {\n                        \"url\": \"http:\/\/hl7.org\/fhir\/us\/davinci-deqm\/StructureDefinition\/extension-criteriaReference\",\n                        \"valueString\": \"sde-patient-sex\"\n                      }\n                    ],\n                    \"reference\": \"#909a511c-823f-4f4c-8012-34f987cc4ae2\"\n                  }\n                }\n              ],\n              \"status\": \"complete\",\n              \"type\": \"summary\",\n              \"measure\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\",\n              \"date\": \"2026-02-09T15:34:23-05:00\",\n              \"period\": {\n                \"start\": \"2023-12-31T19:00:00-05:00\",\n                \"end\": \"2024-12-31T18:59:59-05:00\"\n              },\n              \"group\": [\n                {\n                  \"id\": \"group-1\",\n                  \"population\": [\n                    {\n                      \"id\": \"initial-population\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"initial-population\",\n                            \"display\": \"Initial Population\"\n                          }\n                        ]\n                      },\n                      \"count\": 6\n                    },\n                    {\n                      \"id\": \"denominator\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"denominator\",\n                            \"display\": \"Denominator\"\n                          }\n                        ]\n                      },\n                      \"count\": 4\n                    },\n                    {\n                      \"id\": \"denominator-exclusion\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"denominator-exclusion\",\n                            \"display\": \"Denominator-Exclusion\"\n                          }\n                        ]\n                      },\n                      \"count\": 0\n                    },\n                    {\n                      \"id\": \"denominator-exception\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"denominator-exception\",\n                            \"display\": \"Denominator-Exception\"\n                          }\n                        ]\n                      },\n                      \"count\": 0\n                    },\n                    {\n                      \"id\": \"numerator\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"numerator\",\n                            \"display\": \"Numerator\"\n                          }\n                        ]\n                      },\n                      \"count\": 2\n                    },\n                    {\n                      \"id\": \"numerator-exclusion\",\n                      \"code\": {\n                        \"coding\": [\n                          {\n                            \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                            \"code\": \"numerator-exclusion\",\n                            \"display\": \"Numerator-Exclusion\"\n                          }\n                        ]\n                      },\n                      \"count\": 0\n                    }\n                  ],\n                  \"measureScore\": {\n                    \"value\": 0.5\n                  },\n                  \"stratifier\": [\n                    {\n                      \"id\": \"stratifier\",\n                      \"code\": [\n                        {\n                          \"text\": \"list of string\"\n                        }\n                      ],\n                      \"stratum\": [\n                        {\n                          \"population\": [\n                            {\n                              \"id\": \"initial-population\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"initial-population\",\n                                    \"display\": \"Initial Population\"\n                                  }\n                                ]\n                              },\n                              \"count\": 0\n                            },\n                            {\n                              \"id\": \"denominator\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"denominator\",\n                                    \"display\": \"Denominator\"\n                                  }\n                                ]\n                              },\n                              \"count\": 0\n                            },\n                            {\n                              \"id\": \"denominator-exclusion\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"denominator-exclusion\",\n                                    \"display\": \"Denominator-Exclusion\"\n                                  }\n                                ]\n                              },\n                              \"count\": 0\n                            },\n                            {\n                              \"id\": \"denominator-exception\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"denominator-exception\",\n                                    \"display\": \"Denominator-Exception\"\n                                  }\n                                ]\n                              },\n                              \"count\": 0\n                            },\n                            {\n                              \"id\": \"numerator\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"numerator\",\n                                    \"display\": \"Numerator\"\n                                  }\n                                ]\n                              },\n                              \"count\": 0\n                            },\n                            {\n                              \"id\": \"numerator-exclusion\",\n                              \"code\": {\n                                \"coding\": [\n                                  {\n                                    \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                                    \"code\": \"numerator-exclusion\",\n                                    \"display\": \"Numerator-Exclusion\"\n                                  }\n                                ]\n                              },\n                              \"count\": 0\n                            }\n                          ]\n                        }\n                      ]\n                    }\n                  ]\n                }\n              ]\n            }\n          }\n        ]\n      }\n    }\n  ]\n}\n \n"},{"result":{"nanos":298125,"startTime":1770740033343,"endTime":1770740033343,"millis":0.298125,"status":"passed"},"step":{"comments":["# Extract MeasureReport from Parameters\/Bundle structure if needed"],"line":24,"prefix":"*","index":9,"text":"def expectedReport = expectedReportRaw.resourceType == 'Parameters' ? expectedReportRaw.parameter[0].resource.entry[0].resource : expectedReportRaw"}},{"result":{"nanos":15623125,"startTime":1770740033343,"endTime":1770740033359,"millis":15.623125,"status":"passed"},"step":{"line":25,"prefix":"*","index":10,"text":"karate.log('Extracted expectedReport:', expectedReport)"},"stepLog":"11:13:53.359 Extracted expectedReport: {\n  \"resourceType\": \"MeasureReport\",\n  \"id\": \"f17a88f5-8c03-466e-9de7-7e246ae38fa1\",\n  \"contained\": [\n    {\n      \"resourceType\": \"Observation\",\n      \"id\": \"909a511c-823f-4f4c-8012-34f987cc4ae2\",\n      \"extension\": [\n        {\n          \"url\": \"http:\/\/hl7.org\/fhir\/StructureDefinition\/cqf-measureInfo\",\n          \"extension\": [\n            {\n              \"url\": \"measure\",\n              \"valueCanonical\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\"\n            }\n          ]\n        }\n      ],\n      \"status\": \"final\",\n      \"code\": {\n        \"coding\": [\n          {\n            \"code\": \"F\"\n          }\n        ]\n      },\n      \"valueInteger\": 2\n    }\n  ],\n  \"extension\": [\n    {\n      \"url\": \"http:\/\/hl7.org\/fhir\/5.0\/StructureDefinition\/extension-MeasureReport.supplementalDataElement.reference\",\n      \"valueReference\": {\n        \"extension\": [\n          {\n            \"url\": \"http:\/\/hl7.org\/fhir\/us\/davinci-deqm\/StructureDefinition\/extension-criteriaReference\",\n            \"valueString\": \"sde-patient-sex\"\n          }\n        ],\n        \"reference\": \"#909a511c-823f-4f4c-8012-34f987cc4ae2\"\n      }\n    }\n  ],\n  \"status\": \"complete\",\n  \"type\": \"summary\",\n  \"measure\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\",\n  \"date\": \"2026-02-09T15:34:23-05:00\",\n  \"period\": {\n    \"start\": \"2023-12-31T19:00:00-05:00\",\n    \"end\": \"2024-12-31T18:59:59-05:00\"\n  },\n  \"group\": [\n    {\n      \"id\": \"group-1\",\n      \"population\": [\n        {\n          \"id\": \"initial-population\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"initial-population\",\n                \"display\": \"Initial Population\"\n              }\n            ]\n          },\n          \"count\": 6\n        },\n        {\n          \"id\": \"denominator\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"denominator\",\n                \"display\": \"Denominator\"\n              }\n            ]\n          },\n          \"count\": 4\n        },\n        {\n          \"id\": \"denominator-exclusion\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"denominator-exclusion\",\n                \"display\": \"Denominator-Exclusion\"\n              }\n            ]\n          },\n          \"count\": 0\n        },\n        {\n          \"id\": \"denominator-exception\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"denominator-exception\",\n                \"display\": \"Denominator-Exception\"\n              }\n            ]\n          },\n          \"count\": 0\n        },\n        {\n          \"id\": \"numerator\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"numerator\",\n                \"display\": \"Numerator\"\n              }\n            ]\n          },\n          \"count\": 2\n        },\n        {\n          \"id\": \"numerator-exclusion\",\n          \"code\": {\n            \"coding\": [\n              {\n                \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                \"code\": \"numerator-exclusion\",\n                \"display\": \"Numerator-Exclusion\"\n              }\n            ]\n          },\n          \"count\": 0\n        }\n      ],\n      \"measureScore\": {\n        \"value\": 0.5\n      },\n      \"stratifier\": [\n        {\n          \"id\": \"stratifier\",\n          \"code\": [\n            {\n              \"text\": \"list of string\"\n            }\n          ],\n          \"stratum\": [\n            {\n              \"population\": [\n                {\n                  \"id\": \"initial-population\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"initial-population\",\n                        \"display\": \"Initial Population\"\n                      }\n                    ]\n                  },\n                  \"count\": 0\n                },\n                {\n                  \"id\": \"denominator\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"denominator\",\n                        \"display\": \"Denominator\"\n                      }\n                    ]\n                  },\n                  \"count\": 0\n                },\n                {\n                  \"id\": \"denominator-exclusion\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"denominator-exclusion\",\n                        \"display\": \"Denominator-Exclusion\"\n                      }\n                    ]\n                  },\n                  \"count\": 0\n                },\n                {\n                  \"id\": \"denominator-exception\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"denominator-exception\",\n                        \"display\": \"Denominator-Exception\"\n                      }\n                    ]\n                  },\n                  \"count\": 0\n                },\n                {\n                  \"id\": \"numerator\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"numerator\",\n                        \"display\": \"Numerator\"\n                      }\n                    ]\n                  },\n                  \"count\": 0\n                },\n                {\n                  \"id\": \"numerator-exclusion\",\n                  \"code\": {\n                    \"coding\": [\n                      {\n                        \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                        \"code\": \"numerator-exclusion\",\n                        \"display\": \"Numerator-Exclusion\"\n                      }\n                    ]\n                  },\n                  \"count\": 0\n                }\n              ]\n            }\n          ]\n        }\n      ]\n    }\n  ]\n}\n \n"},{"result":{"nanos":441584,"startTime":1770740033359,"endTime":1770740033359,"millis":0.441584,"status":"passed"},"step":{"comments":["# Verify reports have groups"],"line":28,"prefix":"*","index":11,"text":"match actualReport.group == '#present'"}},{"result":{"nanos":485917,"startTime":1770740033360,"endTime":1770740033360,"millis":0.485917,"status":"passed"},"step":{"line":29,"prefix":"*","index":12,"text":"match expectedReport.group == '#present'"}},{"result":{"nanos":10899166,"startTime":1770740033360,"endTime":1770740033371,"millis":10.899166,"status":"passed"},"step":{"comments":["# Step 3: Compare reports (calls common function)"],"line":32,"prefix":"*","index":13,"text":"karate.set('actualForComparison', actualReport)"}},{"result":{"nanos":8487542,"startTime":1770740033371,"endTime":1770740033379,"millis":8.487542,"status":"passed"},"step":{"line":33,"prefix":"*","index":14,"text":"karate.set('expectedForComparison', expectedReport)"}},{"result":{"nanos":138091500,"startTime":1770740033380,"endTime":1770740033518,"millis":138.0915,"status":"passed"},"step":{"line":34,"prefix":"*","index":15,"text":"def comparison = karate.call('classpath:features\/common\/compare-reports.feature', { actual: karate.get('actualForComparison'), expected: karate.get('expectedForComparison'), measureId: measureId })"},"callResults":[{"prefixedPath":"classpath:features\/common\/compare-reports.feature","loopIndex":-1,"callDepth":1,"description":"","resultDate":"2026-02-10 11:13:53 a.m.","durationMillis":110.685879,"callArg":{"actual":{"resourceType":"MeasureReport","id":"e9a08ac1-4041-4493-9429-6c889b20e569","contained":[{"resourceType":"Observation","id":"86b95c4e-7e78-4f78-b947-b853ebc97031","extension":[{"url":"http:\/\/hl7.org\/fhir\/StructureDefinition\/cqf-measureInfo","extension":[{"url":"measure","valueCanonical":"http:\/\/example.com\/Measure\/3ProportionStringCriteria"}]}],"status":"final","code":{"coding":[{"code":"F"}]},"valueInteger":2}],"extension":[{"url":"http:\/\/hl7.org\/fhir\/5.0\/StructureDefinition\/extension-MeasureReport.supplementalDataElement.reference","valueReference":{"extension":[{"url":"http:\/\/hl7.org\/fhir\/us\/davinci-deqm\/StructureDefinition\/extension-criteriaReference","valueString":"sde-patient-sex"}],"reference":"#86b95c4e-7e78-4f78-b947-b853ebc97031"}}],"status":"complete","type":"summary","measure":"http:\/\/example.com\/Measure\/3ProportionStringCriteria","date":"2026-02-10T11:13:53-05:00","period":{"start":"2023-12-31T19:00:00-05:00","end":"2024-12-31T18:59:59-05:00"},"group":[{"id":"group-1","population":[{"id":"initial-population","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"initial-population","display":"Initial Population"}]},"count":6},{"id":"denominator","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator","display":"Denominator"}]},"count":4},{"id":"denominator-exclusion","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator-exclusion","display":"Denominator-Exclusion"}]},"count":0},{"id":"denominator-exception","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator-exception","display":"Denominator-Exception"}]},"count":0},{"id":"numerator","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"numerator","display":"Numerator"}]},"count":2},{"id":"numerator-exclusion","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"numerator-exclusion","display":"Numerator-Exclusion"}]},"count":0}],"measureScore":{"value":0.5},"stratifier":[{"id":"stratifier-1","code":[{"text":"Age and Gender Stratification"}],"stratum":[{"value":{"text":"female"},"population":[{"id":"initial-population","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"initial-population","display":"Initial Population"}]},"count":3},{"id":"denominator","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator","display":"Denominator"}]},"count":2},{"id":"denominator-exclusion","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator-exclusion","display":"Denominator-Exclusion"}]},"count":0},{"id":"denominator-exception","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator-exception","display":"Denominator-Exception"}]},"count":0},{"id":"numerator","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"numerator","display":"Numerator"}]},"count":1},{"id":"numerator-exclusion","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"numerator-exclusion","display":"Numerator-Exclusion"}]},"count":0}],"measureScore":{"value":0.5}}]}]}]},"expected":{"resourceType":"MeasureReport","id":"f17a88f5-8c03-466e-9de7-7e246ae38fa1","contained":[{"resourceType":"Observation","id":"909a511c-823f-4f4c-8012-34f987cc4ae2","extension":[{"url":"http:\/\/hl7.org\/fhir\/StructureDefinition\/cqf-measureInfo","extension":[{"url":"measure","valueCanonical":"http:\/\/example.com\/Measure\/3ProportionStringCriteria"}]}],"status":"final","code":{"coding":[{"code":"F"}]},"valueInteger":2}],"extension":[{"url":"http:\/\/hl7.org\/fhir\/5.0\/StructureDefinition\/extension-MeasureReport.supplementalDataElement.reference","valueReference":{"extension":[{"url":"http:\/\/hl7.org\/fhir\/us\/davinci-deqm\/StructureDefinition\/extension-criteriaReference","valueString":"sde-patient-sex"}],"reference":"#909a511c-823f-4f4c-8012-34f987cc4ae2"}}],"status":"complete","type":"summary","measure":"http:\/\/example.com\/Measure\/3ProportionStringCriteria","date":"2026-02-09T15:34:23-05:00","period":{"start":"2023-12-31T19:00:00-05:00","end":"2024-12-31T18:59:59-05:00"},"group":[{"id":"group-1","population":[{"id":"initial-population","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"initial-population","display":"Initial Population"}]},"count":6},{"id":"denominator","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator","display":"Denominator"}]},"count":4},{"id":"denominator-exclusion","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator-exclusion","display":"Denominator-Exclusion"}]},"count":0},{"id":"denominator-exception","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator-exception","display":"Denominator-Exception"}]},"count":0},{"id":"numerator","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"numerator","display":"Numerator"}]},"count":2},{"id":"numerator-exclusion","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"numerator-exclusion","display":"Numerator-Exclusion"}]},"count":0}],"measureScore":{"value":0.5},"stratifier":[{"id":"stratifier","code":[{"text":"list of string"}],"stratum":[{"population":[{"id":"initial-population","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"initial-population","display":"Initial Population"}]},"count":0},{"id":"denominator","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator","display":"Denominator"}]},"count":0},{"id":"denominator-exclusion","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator-exclusion","display":"Denominator-Exclusion"}]},"count":0},{"id":"denominator-exception","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"denominator-exception","display":"Denominator-Exception"}]},"count":0},{"id":"numerator","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"numerator","display":"Numerator"}]},"count":0},{"id":"numerator-exclusion","code":{"coding":[{"system":"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population","code":"numerator-exclusion","display":"Numerator-Exclusion"}]},"count":0}]}]}]}]},"measureId":"3ProportionStringCriteria"},"failedCount":0,"packageQualifiedName":"features.common.compare-reports","relativePath":"features\/common\/compare-reports.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":949375,"startTime":1770740033403,"endTime":1770740033404,"millis":0.949375,"status":"passed"},"step":{"line":6,"prefix":"*","index":0,"text":"karate.log('__arg:', __arg)"},"stepLog":"11:13:53.404 __arg: {\n  \"actual\": {\n    \"resourceType\": \"MeasureReport\",\n    \"id\": \"e9a08ac1-4041-4493-9429-6c889b20e569\",\n    \"contained\": [\n      {\n        \"resourceType\": \"Observation\",\n        \"id\": \"86b95c4e-7e78-4f78-b947-b853ebc97031\",\n        \"extension\": [\n          {\n            \"url\": \"http:\/\/hl7.org\/fhir\/StructureDefinition\/cqf-measureInfo\",\n            \"extension\": [\n              {\n                \"url\": \"measure\",\n                \"valueCanonical\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\"\n              }\n            ]\n          }\n        ],\n        \"status\": \"final\",\n        \"code\": {\n          \"coding\": [\n            {\n              \"code\": \"F\"\n            }\n          ]\n        },\n        \"valueInteger\": 2\n      }\n    ],\n    \"extension\": [\n      {\n        \"url\": \"http:\/\/hl7.org\/fhir\/5.0\/StructureDefinition\/extension-MeasureReport.supplementalDataElement.reference\",\n        \"valueReference\": {\n          \"extension\": [\n            {\n              \"url\": \"http:\/\/hl7.org\/fhir\/us\/davinci-deqm\/StructureDefinition\/extension-criteriaReference\",\n              \"valueString\": \"sde-patient-sex\"\n            }\n          ],\n          \"reference\": \"#86b95c4e-7e78-4f78-b947-b853ebc97031\"\n        }\n      }\n    ],\n    \"status\": \"complete\",\n    \"type\": \"summary\",\n    \"measure\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\",\n    \"date\": \"2026-02-10T11:13:53-05:00\",\n    \"period\": {\n      \"start\": \"2023-12-31T19:00:00-05:00\",\n      \"end\": \"2024-12-31T18:59:59-05:00\"\n    },\n    \"group\": [\n      {\n        \"id\": \"group-1\",\n        \"population\": [\n          {\n            \"id\": \"initial-population\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"initial-population\",\n                  \"display\": \"Initial Population\"\n                }\n              ]\n            },\n            \"count\": 6\n          },\n          {\n            \"id\": \"denominator\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"denominator\",\n                  \"display\": \"Denominator\"\n                }\n              ]\n            },\n            \"count\": 4\n          },\n          {\n            \"id\": \"denominator-exclusion\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"denominator-exclusion\",\n                  \"display\": \"Denominator-Exclusion\"\n                }\n              ]\n            },\n            \"count\": 0\n          },\n          {\n            \"id\": \"denominator-exception\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"denominator-exception\",\n                  \"display\": \"Denominator-Exception\"\n                }\n              ]\n            },\n            \"count\": 0\n          },\n          {\n            \"id\": \"numerator\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"numerator\",\n                  \"display\": \"Numerator\"\n                }\n              ]\n            },\n            \"count\": 2\n          },\n          {\n            \"id\": \"numerator-exclusion\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"numerator-exclusion\",\n                  \"display\": \"Numerator-Exclusion\"\n                }\n              ]\n            },\n            \"count\": 0\n          }\n        ],\n        \"measureScore\": {\n          \"value\": 0.5\n        },\n        \"stratifier\": [\n          {\n            \"id\": \"stratifier-1\",\n            \"code\": [\n              {\n                \"text\": \"Age and Gender Stratification\"\n              }\n            ],\n            \"stratum\": [\n              {\n                \"value\": {\n                  \"text\": \"female\"\n                },\n                \"population\": [\n                  {\n                    \"id\": \"initial-population\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"initial-population\",\n                          \"display\": \"Initial Population\"\n                        }\n                      ]\n                    },\n                    \"count\": 3\n                  },\n                  {\n                    \"id\": \"denominator\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"denominator\",\n                          \"display\": \"Denominator\"\n                        }\n                      ]\n                    },\n                    \"count\": 2\n                  },\n                  {\n                    \"id\": \"denominator-exclusion\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"denominator-exclusion\",\n                          \"display\": \"Denominator-Exclusion\"\n                        }\n                      ]\n                    },\n                    \"count\": 0\n                  },\n                  {\n                    \"id\": \"denominator-exception\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"denominator-exception\",\n                          \"display\": \"Denominator-Exception\"\n                        }\n                      ]\n                    },\n                    \"count\": 0\n                  },\n                  {\n                    \"id\": \"numerator\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"numerator\",\n                          \"display\": \"Numerator\"\n                        }\n                      ]\n                    },\n                    \"count\": 1\n                  },\n                  {\n                    \"id\": \"numerator-exclusion\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"numerator-exclusion\",\n                          \"display\": \"Numerator-Exclusion\"\n                        }\n                      ]\n                    },\n                    \"count\": 0\n                  }\n                ],\n                \"measureScore\": {\n                  \"value\": 0.5\n                }\n              }\n            ]\n          }\n        ]\n      }\n    ]\n  },\n  \"expected\": {\n    \"resourceType\": \"MeasureReport\",\n    \"id\": \"f17a88f5-8c03-466e-9de7-7e246ae38fa1\",\n    \"contained\": [\n      {\n        \"resourceType\": \"Observation\",\n        \"id\": \"909a511c-823f-4f4c-8012-34f987cc4ae2\",\n        \"extension\": [\n          {\n            \"url\": \"http:\/\/hl7.org\/fhir\/StructureDefinition\/cqf-measureInfo\",\n            \"extension\": [\n              {\n                \"url\": \"measure\",\n                \"valueCanonical\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\"\n              }\n            ]\n          }\n        ],\n        \"status\": \"final\",\n        \"code\": {\n          \"coding\": [\n            {\n              \"code\": \"F\"\n            }\n          ]\n        },\n        \"valueInteger\": 2\n      }\n    ],\n    \"extension\": [\n      {\n        \"url\": \"http:\/\/hl7.org\/fhir\/5.0\/StructureDefinition\/extension-MeasureReport.supplementalDataElement.reference\",\n        \"valueReference\": {\n          \"extension\": [\n            {\n              \"url\": \"http:\/\/hl7.org\/fhir\/us\/davinci-deqm\/StructureDefinition\/extension-criteriaReference\",\n              \"valueString\": \"sde-patient-sex\"\n            }\n          ],\n          \"reference\": \"#909a511c-823f-4f4c-8012-34f987cc4ae2\"\n        }\n      }\n    ],\n    \"status\": \"complete\",\n    \"type\": \"summary\",\n    \"measure\": \"http:\/\/example.com\/Measure\/3ProportionStringCriteria\",\n    \"date\": \"2026-02-09T15:34:23-05:00\",\n    \"period\": {\n      \"start\": \"2023-12-31T19:00:00-05:00\",\n      \"end\": \"2024-12-31T18:59:59-05:00\"\n    },\n    \"group\": [\n      {\n        \"id\": \"group-1\",\n        \"population\": [\n          {\n            \"id\": \"initial-population\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"initial-population\",\n                  \"display\": \"Initial Population\"\n                }\n              ]\n            },\n            \"count\": 6\n          },\n          {\n            \"id\": \"denominator\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"denominator\",\n                  \"display\": \"Denominator\"\n                }\n              ]\n            },\n            \"count\": 4\n          },\n          {\n            \"id\": \"denominator-exclusion\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"denominator-exclusion\",\n                  \"display\": \"Denominator-Exclusion\"\n                }\n              ]\n            },\n            \"count\": 0\n          },\n          {\n            \"id\": \"denominator-exception\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"denominator-exception\",\n                  \"display\": \"Denominator-Exception\"\n                }\n              ]\n            },\n            \"count\": 0\n          },\n          {\n            \"id\": \"numerator\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"numerator\",\n                  \"display\": \"Numerator\"\n                }\n              ]\n            },\n            \"count\": 2\n          },\n          {\n            \"id\": \"numerator-exclusion\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                  \"code\": \"numerator-exclusion\",\n                  \"display\": \"Numerator-Exclusion\"\n                }\n              ]\n            },\n            \"count\": 0\n          }\n        ],\n        \"measureScore\": {\n          \"value\": 0.5\n        },\n        \"stratifier\": [\n          {\n            \"id\": \"stratifier\",\n            \"code\": [\n              {\n                \"text\": \"list of string\"\n              }\n            ],\n            \"stratum\": [\n              {\n                \"population\": [\n                  {\n                    \"id\": \"initial-population\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"initial-population\",\n                          \"display\": \"Initial Population\"\n                        }\n                      ]\n                    },\n                    \"count\": 0\n                  },\n                  {\n                    \"id\": \"denominator\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"denominator\",\n                          \"display\": \"Denominator\"\n                        }\n                      ]\n                    },\n                    \"count\": 0\n                  },\n                  {\n                    \"id\": \"denominator-exclusion\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"denominator-exclusion\",\n                          \"display\": \"Denominator-Exclusion\"\n                        }\n                      ]\n                    },\n                    \"count\": 0\n                  },\n                  {\n                    \"id\": \"denominator-exception\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"denominator-exception\",\n                          \"display\": \"Denominator-Exception\"\n                        }\n                      ]\n                    },\n                    \"count\": 0\n                  },\n                  {\n                    \"id\": \"numerator\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"numerator\",\n                          \"display\": \"Numerator\"\n                        }\n                      ]\n                    },\n                    \"count\": 0\n                  },\n                  {\n                    \"id\": \"numerator-exclusion\",\n                    \"code\": {\n                      \"coding\": [\n                        {\n                          \"system\": \"http:\/\/terminology.hl7.org\/CodeSystem\/measure-population\",\n                          \"code\": \"numerator-exclusion\",\n                          \"display\": \"Numerator-Exclusion\"\n                        }\n                      ]\n                    },\n                    \"count\": 0\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      }\n    ]\n  },\n  \"measureId\": \"3ProportionStringCriteria\"\n}\n \n"},{"result":{"nanos":272750,"startTime":1770740033404,"endTime":1770740033404,"millis":0.27275,"status":"passed"},"step":{"line":7,"prefix":"*","index":1,"text":"def actual = __arg.actual"}},{"result":{"nanos":234584,"startTime":1770740033405,"endTime":1770740033405,"millis":0.234584,"status":"passed"},"step":{"line":8,"prefix":"*","index":2,"text":"karate.log('actual type:', typeof actual)"},"stepLog":"11:13:53.405 actual type: object \n"},{"result":{"nanos":228667,"startTime":1770740033405,"endTime":1770740033405,"millis":0.228667,"status":"passed"},"step":{"line":9,"prefix":"*","index":3,"text":"karate.log('actual has group?:', actual.group != null)"},"stepLog":"11:13:53.405 actual has group?: true \n"},{"result":{"nanos":4053875,"startTime":1770740033405,"endTime":1770740033409,"millis":4.053875,"status":"passed"},"step":{"line":10,"prefix":"*","index":4,"text":"def expected = __arg.expected"}},{"result":{"nanos":822833,"startTime":1770740033411,"endTime":1770740033412,"millis":0.822833,"status":"passed"},"step":{"line":11,"prefix":"*","index":5,"text":"def measureId = __arg.measureId"}},{"result":{"nanos":3738166,"startTime":1770740033412,"endTime":1770740033416,"millis":3.738166,"status":"passed"},"step":{"line":13,"prefix":"*","index":6,"text":"def actualGroup = actual.group[0]"}},{"result":{"nanos":740417,"startTime":1770740033416,"endTime":1770740033417,"millis":0.740417,"status":"passed"},"step":{"line":14,"prefix":"*","index":7,"text":"def expectedGroup = expected.group[0]"}},{"result":{"nanos":846167,"startTime":1770740033417,"endTime":1770740033418,"millis":0.846167,"status":"passed"},"step":{"line":16,"prefix":"*","index":8,"text":"karate.log('\\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—')"},"stepLog":"11:13:53.418 \nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— \n"},{"result":{"nanos":761167,"startTime":1770740033418,"endTime":1770740033419,"millis":0.761167,"status":"passed"},"step":{"line":17,"prefix":"*","index":9,"text":"karate.log('â•‘  Comparing Populations for', measureId)"},"stepLog":"11:13:53.419 â•‘  Comparing Populations for 3ProportionStringCriteria \n"},{"result":{"nanos":246166,"startTime":1770740033419,"endTime":1770740033419,"millis":0.246166,"status":"passed"},"step":{"line":18,"prefix":"*","index":10,"text":"karate.log('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n')"},"stepLog":"11:13:53.419 â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n \n"},{"result":{"nanos":213583,"startTime":1770740033419,"endTime":1770740033419,"millis":0.213583,"status":"passed"},"step":{"comments":["# Extract populations"],"line":21,"prefix":"*","index":11,"text":"def actualPops = actualGroup.population"}},{"result":{"nanos":126708,"startTime":1770740033419,"endTime":1770740033419,"millis":0.126708,"status":"passed"},"step":{"line":22,"prefix":"*","index":12,"text":"def expectedPops = expectedGroup.population"}},{"result":{"nanos":149833,"startTime":1770740033419,"endTime":1770740033419,"millis":0.149833,"status":"passed"},"step":{"comments":["# Simple comparison using Karate match"],"line":25,"prefix":"*","index":13,"text":"def allMatch = true"}},{"result":{"nanos":156667,"startTime":1770740033420,"endTime":1770740033420,"millis":0.156667,"status":"passed"},"step":{"line":26,"prefix":"*","index":14,"text":"def comparisonResults = {}"}},{"result":{"nanos":9810625,"startTime":1770740033420,"endTime":1770740033430,"millis":9.810625,"status":"passed"},"step":{"endLine":59,"comments":["# Compare each expected population with actual"],"line":29,"prefix":"*","docString":"function() {\n  for (var i = 0; i < expectedPops.length; i++) {\n    var exp = expectedPops[i];\n    var popCode = exp.code.coding[0].code;\n    var expCount = exp.count;\n    var act = actualPops.find(function(p) {\n      return p.code.coding[0].code === popCode;\n    });\n    var actCount = act ? act.count : 0;\n    var match = actCount === expCount;\n    comparisonResults[popCode] = {\n      actual: actCount,\n      expected: expCount,\n      match: match\n    };\n    if (match) {\n      karate.log('  âœ… ' + popCode + ': ' + actCount);\n    } else {\n      karate.log('  âŒ ' + popCode + ': Expected ' + expCount + ', Got ' + actCount);\n      allMatch = false;\n    }\n  }\n  return allMatch;\n}","index":15,"text":"def comparePopulations ="}},{"result":{"nanos":28588334,"startTime":1770740033430,"endTime":1770740033459,"millis":28.588334,"status":"passed"},"step":{"line":61,"prefix":"*","index":16,"text":"def allMatch = comparePopulations()"},"stepLog":"11:13:53.431   âœ… initial-population: 6 \n11:13:53.450   âœ… denominator: 4 \n11:13:53.456   âœ… denominator-exclusion: 0 \n11:13:53.458   âœ… denominator-exception: 0 \n11:13:53.458   âœ… numerator: 2 \n11:13:53.458   âœ… numerator-exclusion: 0 \n"},{"result":{"nanos":432750,"startTime":1770740033458,"endTime":1770740033458,"millis":0.43275,"status":"passed"},"step":{"line":63,"prefix":"*","index":17,"text":"karate.log('\\n' + (allMatch ? 'âœ… All populations match!' : 'âŒ Some populations do not match'))"},"stepLog":"11:13:53.459 \nâœ… All populations match! \n"},{"result":{"nanos":95167,"startTime":1770740033459,"endTime":1770740033459,"millis":0.095167,"status":"passed"},"step":{"comments":["# Compare measure score if present"],"line":66,"prefix":"*","index":18,"text":"def measureScoreMatch = true"}},{"result":{"nanos":229292,"startTime":1770740033459,"endTime":1770740033459,"millis":0.229292,"status":"passed"},"step":{"line":67,"prefix":"*","index":19,"text":"def actualMeasureScore = actualGroup.measureScore ? actualGroup.measureScore.value : null"}},{"result":{"nanos":361375,"startTime":1770740033459,"endTime":1770740033459,"millis":0.361375,"status":"passed"},"step":{"line":68,"prefix":"*","index":20,"text":"def expectedMeasureScore = expectedGroup.measureScore ? expectedGroup.measureScore.value : null"}},{"result":{"nanos":3242334,"startTime":1770740033459,"endTime":1770740033462,"millis":3.242334,"status":"passed"},"step":{"endLine":95,"line":70,"prefix":"*","docString":"function() {\n  if (expectedMeasureScore === null && actualMeasureScore === null) {\n    karate.log('  â„¹ï¸  No measure score to compare');\n    return true;\n  }\n  if (expectedMeasureScore === null || actualMeasureScore === null) {\n    karate.log('  âŒ Measure score missing in one report');\n    return false;\n  }\n  \/\/ Compare with small tolerance for floating point precision\n  var tolerance = 0.0001;\n  var diff = Math.abs(actualMeasureScore - expectedMeasureScore);\n  var match = diff < tolerance;\n  if (match) {\n    karate.log('  â„¹ï¸  Measure Score: ' + actualMeasureScore.toFixed(4) + ' (matches expected)');\n  } else {\n    karate.log('  âš ï¸  Measure Score: Expected ' + expectedMeasureScore.toFixed(4) + ', Got ' + actualMeasureScore.toFixed(4) + ' (informational only)');\n  }\n  return match;\n}","index":21,"text":"def compareMeasureScore ="}},{"result":{"nanos":842584,"startTime":1770740033463,"endTime":1770740033464,"millis":0.842584,"status":"passed"},"step":{"line":97,"prefix":"*","index":22,"text":"def measureScoreMatch = compareMeasureScore()"},"stepLog":"11:13:53.464   â„¹ï¸  Measure Score: 0.5000 (matches expected) \n"},{"result":{"nanos":206834,"startTime":1770740033464,"endTime":1770740033464,"millis":0.206834,"status":"passed"},"step":{"comments":["# Compare stratifiers if present"],"line":100,"prefix":"*","index":23,"text":"def stratifierResults = {}"}},{"result":{"nanos":129834,"startTime":1770740033464,"endTime":1770740033464,"millis":0.129834,"status":"passed"},"step":{"line":101,"prefix":"*","index":24,"text":"def stratifiersMatch = true"}},{"result":{"nanos":195958,"startTime":1770740033464,"endTime":1770740033464,"millis":0.195958,"status":"passed"},"step":{"line":103,"prefix":"*","index":25,"text":"def actualStratifiers = actualGroup.stratifier || []"}},{"result":{"nanos":248458,"startTime":1770740033464,"endTime":1770740033464,"millis":0.248458,"status":"passed"},"step":{"line":104,"prefix":"*","index":26,"text":"def expectedStratifiers = expectedGroup.stratifier || []"}},{"result":{"nanos":291917,"startTime":1770740033465,"endTime":1770740033465,"millis":0.291917,"status":"passed"},"step":{"line":106,"prefix":"*","index":27,"text":"if (expectedStratifiers.length > 0) karate.log('\\nðŸ“Š Comparing Stratifiers...')"},"stepLog":"11:13:53.465 \nðŸ“Š Comparing Stratifiers... \n"},{"result":{"nanos":17366125,"startTime":1770740033465,"endTime":1770740033482,"millis":17.366125,"status":"passed"},"step":{"endLine":186,"line":108,"prefix":"*","docString":"function() {\n  if (expectedStratifiers.length === 0) return true;\n  var allStratMatch = true;\n  var stratResults = {};\n  for (var i = 0; i < expectedStratifiers.length; i++) {\n    var expStrat = expectedStratifiers[i];\n    var actStrat = actualStratifiers[i];\n    if (!actStrat) {\n      karate.log('  âŒ Stratifier ' + i + ' missing in actual report');\n      allStratMatch = false;\n      continue;\n    }\n    var stratCode = 'stratifier-' + i;\n    try {\n      if (expStrat.code && expStrat.code.length > 0 && expStrat.code[0].coding && expStrat.code[0].coding.length > 0) {\n        stratCode = expStrat.code[0].coding[0].code;\n      }\n    } catch (e) {\n      \/\/ Use default stratifier name\n    }\n    stratResults[stratCode] = { stratum: {} };\n    var expStratum = expStrat.stratum || [];\n    var actStratum = actStrat.stratum || [];\n    for (var j = 0; j < expStratum.length; j++) {\n      var expStrum = expStratum[j];\n      var actStrum = actStratum[j];\n      if (!actStrum) {\n        karate.log('  âŒ Stratum ' + j + ' missing');\n        allStratMatch = false;\n        continue;\n      }\n      var stratValue = expStrum.value ? expStrum.value.text : 'Stratum-' + j;\n      stratResults[stratCode].stratum[stratValue] = {};\n      var expPops = expStrum.population || [];\n      var actPops = actStrum.population || [];\n      for (var k = 0; k < expPops.length; k++) {\n        var expPop = expPops[k];\n        var popCode = expPop.code.coding[0].code;\n        var expCount = expPop.count;\n        var actPop = actPops.find(function(p) {\n          return p.code.coding[0].code === popCode;\n        });\n        var actCount = actPop ? actPop.count : 0;\n        var match = actCount === expCount;\n        stratResults[stratCode].stratum[stratValue][popCode] = {\n          expected: expCount,\n          actual: actCount,\n          match: match\n        };\n        if (match) {\n          karate.log('  âœ… [' + stratValue + '] ' + popCode + ': ' + actCount);\n        } else {\n          karate.log('  âŒ [' + stratValue + '] ' + popCode + ': Expected ' + expCount + ', Got ' + actCount);\n          allStratMatch = false;\n        }\n      }\n    }\n  }\n  stratifierResults = stratResults;\n  return allStratMatch;\n}","index":28,"text":"def compareStratifiers ="}},{"result":{"nanos":16429417,"startTime":1770740033482,"endTime":1770740033498,"millis":16.429417,"status":"passed"},"step":{"line":188,"prefix":"*","index":29,"text":"def stratifiersMatch = compareStratifiers()"},"stepLog":"11:13:53.498   âŒ [Stratum-0] initial-population: Expected 0, Got 3 \n11:13:53.498   âŒ [Stratum-0] denominator: Expected 0, Got 2 \n11:13:53.498   âœ… [Stratum-0] denominator-exclusion: 0 \n11:13:53.498   âœ… [Stratum-0] denominator-exception: 0 \n11:13:53.498   âŒ [Stratum-0] numerator: Expected 0, Got 1 \n11:13:53.499   âœ… [Stratum-0] numerator-exclusion: 0 \n"},{"result":{"nanos":399625,"startTime":1770740033499,"endTime":1770740033499,"millis":0.399625,"status":"passed"},"step":{"line":190,"prefix":"*","index":30,"text":"karate.log('\\n' + (allMatch && stratifiersMatch ? 'âœ… All populations and stratifiers match!' : 'âŒ Some comparisons failed'))"},"stepLog":"11:13:53.499 \nâŒ Some comparisons failed \n"},{"result":{"nanos":177333,"startTime":1770740033499,"endTime":1770740033499,"millis":0.177333,"status":"passed"},"step":{"line":191,"prefix":"*","index":31,"text":"karate.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n')"},"stepLog":"11:13:53.499 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n \n"},{"result":{"nanos":152959,"startTime":1770740033499,"endTime":1770740033499,"millis":0.152959,"status":"passed"},"step":{"comments":["# Return comparison result (measure score is informational only, doesn't affect pass\/fail)"],"line":194,"prefix":"*","index":32,"text":"def overallMatch = allMatch && stratifiersMatch"}},{"result":{"nanos":12221000,"startTime":1770740033500,"endTime":1770740033512,"millis":12.221,"status":"passed"},"step":{"line":195,"prefix":"*","index":33,"text":"def measureScoreResult = { expected: '#(expectedMeasureScore)', actual: '#(actualMeasureScore)', match: '#(measureScoreMatch)' }"}},{"result":{"nanos":5723000,"startTime":1770740033512,"endTime":1770740033518,"millis":5.723,"status":"passed"},"step":{"line":196,"prefix":"*","index":34,"text":"def comparisonResult = { populations: '#(comparisonResults)', stratifiers: '#(stratifierResults)', measureScore: '#(measureScoreResult)', allMatch: '#(overallMatch)', passed: '#(overallMatch)' }"}}],"line":4,"description":"","durationMillis":110.685879,"failed":false,"tags":["ignore"],"executorName":"main","name":"Compare Population Counts","startTime":1770740033401,"refId":"[1:4]","endTime":1770740033518,"exampleIndex":-1}],"name":"Compare MeasureReports","passedCount":1}]},{"result":{"nanos":627917,"startTime":1770740033518,"endTime":1770740033519,"millis":0.627917,"status":"passed"},"step":{"comments":["# Step 4: Print test summary for terminal visibility"],"line":37,"prefix":"*","index":16,"text":"print ''"},"stepLog":"11:13:53.518 [print]  \n"},{"result":{"nanos":1301208,"startTime":1770740033519,"endTime":1770740033520,"millis":1.301208,"status":"passed"},"step":{"line":38,"prefix":"*","index":17,"text":"print 'â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—'"},"stepLog":"11:13:53.520 [print] â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— \n"},{"result":{"nanos":6362333,"startTime":1770740033520,"endTime":1770740033526,"millis":6.362333,"status":"passed"},"step":{"line":39,"prefix":"*","index":18,"text":"print 'â•‘  TEST RESULT: ' + measureId"},"stepLog":"11:13:53.526 [print] â•‘  TEST RESULT: 3ProportionStringCriteria \n"},{"result":{"nanos":767625,"startTime":1770740033526,"endTime":1770740033527,"millis":0.767625,"status":"passed"},"step":{"line":40,"prefix":"*","index":19,"text":"print 'â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•'"},"stepLog":"11:13:53.527 [print] â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• \n"},{"result":{"nanos":691542,"startTime":1770740033527,"endTime":1770740033528,"millis":0.691542,"status":"passed"},"step":{"comments":["# Print all population results dynamically"],"line":43,"prefix":"*","index":20,"text":"def populations = comparison.comparisonResult.populations"}},{"result":{"nanos":379709,"startTime":1770740033528,"endTime":1770740033528,"millis":0.379709,"status":"passed"},"step":{"line":44,"prefix":"*","index":21,"text":"print ''"},"stepLog":"11:13:53.528 [print]  \n"},{"result":{"nanos":586250,"startTime":1770740033528,"endTime":1770740033529,"millis":0.58625,"status":"passed"},"step":{"line":45,"prefix":"*","index":22,"text":"print 'POPULATIONS:'"},"stepLog":"11:13:53.529 [print] POPULATIONS: \n"},{"result":{"nanos":1454958,"startTime":1770740033529,"endTime":1770740033530,"millis":1.454958,"status":"passed"},"step":{"endLine":59,"line":46,"prefix":"*","docString":"function() {\n  var popKeys = Object.keys(populations);\n  for (var i = 0; i < popKeys.length; i++) {\n    var key = popKeys[i];\n    var pop = populations[key];\n    var icon = pop.match ? 'âœ…' : 'âŒ';\n    var msg = '  ' + icon + ' ' + key + ': Expected=' + pop.expected + ', Actual=' + pop.actual;\n    karate.log(msg);\n    print(msg);\n  }\n}","index":23,"text":"def printPopulations ="}},{"result":{"nanos":8218333,"startTime":1770740033531,"endTime":1770740033539,"millis":8.218333,"status":"passed"},"step":{"line":60,"prefix":"*","index":24,"text":"eval printPopulations()"},"stepLog":"11:13:53.533   âœ… initial-population: Expected=6, Actual=6 \n11:13:53.536   âœ… denominator: Expected=4, Actual=4 \n11:13:53.536   âœ… denominator-exclusion: Expected=0, Actual=0 \n11:13:53.537   âœ… denominator-exception: Expected=0, Actual=0 \n11:13:53.538   âœ… numerator: Expected=2, Actual=2 \n11:13:53.539   âœ… numerator-exclusion: Expected=0, Actual=0 \n"},{"result":{"nanos":336375,"startTime":1770740033539,"endTime":1770740033539,"millis":0.336375,"status":"passed"},"step":{"comments":["# Print stratifier results if present"],"line":63,"prefix":"*","index":25,"text":"def stratifiers = comparison.comparisonResult.stratifiers"}},{"result":{"nanos":272333,"startTime":1770740033539,"endTime":1770740033539,"millis":0.272333,"status":"passed"},"step":{"line":64,"prefix":"*","index":26,"text":"def hasStratifiers = Object.keys(stratifiers).length > 0"}},{"result":{"nanos":4298917,"startTime":1770740033539,"endTime":1770740033543,"millis":4.298917,"status":"passed"},"step":{"endLine":95,"line":65,"prefix":"*","docString":"function() {\n  if (!hasStratifiers) return;\n  print('');\n  print('STRATIFIERS:');\n  var stratKeys = Object.keys(stratifiers);\n  for (var i = 0; i < stratKeys.length; i++) {\n    var stratCode = stratKeys[i];\n    var strat = stratifiers[stratCode];\n    print('  Stratifier: ' + stratCode);\n    var stratumKeys = Object.keys(strat.stratum);\n    for (var j = 0; j < stratumKeys.length; j++) {\n      var stratumValue = stratumKeys[j];\n      var stratum = strat.stratum[stratumValue];\n      print('    [' + stratumValue + ']');\n      var popKeys = Object.keys(stratum);\n      for (var k = 0; k < popKeys.length; k++) {\n        var popCode = popKeys[k];\n        var pop = stratum[popCode];\n        var icon = pop.match ? 'âœ…' : 'âŒ';\n        var msg = '      ' + icon + ' ' + popCode + ': Expected=' + pop.expected + ', Actual=' + pop.actual;\n        print(msg);\n      }\n    }\n  }\n}","index":27,"text":"def printStratifiers ="}},{"result":{"nanos":1297542,"startTime":1770740033544,"endTime":1770740033545,"millis":1.297542,"status":"passed"},"step":{"line":96,"prefix":"*","index":28,"text":"eval printStratifiers()"}},{"result":{"nanos":187166,"startTime":1770740033545,"endTime":1770740033545,"millis":0.187166,"status":"passed"},"step":{"comments":["# Print overall result"],"line":99,"prefix":"*","index":29,"text":"print ''"},"stepLog":"11:13:53.545 [print]  \n"},{"result":{"nanos":234917,"startTime":1770740033545,"endTime":1770740033545,"millis":0.234917,"status":"passed"},"step":{"line":100,"prefix":"*","index":30,"text":"def testResult = comparison.comparisonResult.passed ? 'âœ… PASSED - All assertions match!' : 'âŒ FAILED - Some assertions do not match'"}},{"result":{"nanos":236875,"startTime":1770740033546,"endTime":1770740033546,"millis":0.236875,"status":"passed"},"step":{"line":101,"prefix":"*","index":31,"text":"print testResult"},"stepLog":"11:13:53.546 [print] âŒ FAILED - Some assertions do not match \n"},{"result":{"nanos":75959,"startTime":1770740033546,"endTime":1770740033546,"millis":0.075959,"status":"passed"},"step":{"line":102,"prefix":"*","index":32,"text":"print ''"},"stepLog":"11:13:53.546 [print]  \n"},{"result":{"nanos":432458,"errorMessage":"did not evaluate to 'true': comparison.comparisonResult.passed == true || comparison.comparisonResult.passed == 'true'\nclasspath:features\/measures\/measure-03.feature:105","startTime":1770740033546,"endTime":1770740033546,"millis":0.432458,"status":"failed"},"step":{"comments":["# Step 5: Assert all populations match"],"line":105,"prefix":"*","index":33,"text":"assert comparison.comparisonResult.passed == true || comparison.comparisonResult.passed == 'true'"},"stepLog":"11:13:53.549 classpath:features\/measures\/measure-03.feature:105\n* assert comparison.comparisonResult.passed == true || comparison.comparisonResult.passed == 'true'\ndid not evaluate to 'true': comparison.comparisonResult.passed == true || comparison.comparisonResult.passed == 'true'\nclasspath:features\/measures\/measure-03.feature:105\n"}],"line":6,"description":"","durationMillis":416.718084,"failed":true,"error":"did not evaluate to 'true': comparison.comparisonResult.passed == true || comparison.comparisonResult.passed == 'true'\nclasspath:features\/measures\/measure-03.feature:105","executorName":"main","name":"Evaluate and Validate Measure 03","startTime":1770740033121,"refId":"[1:6]","endTime":1770740033549,"exampleIndex":-1}],"callDepth":0,"name":"Measure 03 - Proportion with String Criteria","description":"","resultDate":"2026-02-10 11:13:53 a.m.","durationMillis":416.718084,"passedCount":0}